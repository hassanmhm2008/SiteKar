# راهنمای اضافه کردن نقش "انبار دار"

## مراحل اجرا:

### 1. اجرای Migration در MySQL
1. به phpMyAdmin بروید
2. دیتابیس `sitekar_db` را انتخاب کنید
3. به تب SQL بروید
4. محتویات فایل `add_warehouse_role.sql` را کپی و اجرا کنید

یا از خط فرمان:
```bash
mysql -u root -p sitekar_db < backend/migrations/add_warehouse_role.sql
```

### 2. تأیید تغییرات
بعد از اجرای SQL:
- جدول `permissions` باید 7 رکورد جدید برای نقش "انبار دار" داشته باشد
- جدول `users` باید نقش "انبار دار" را در ENUM بپذیرد
- مجموعاً 35 رکورد در جدول permissions (5 نقش × 7 صفحه = 35)

### 3. تست سیستم
1. سرور backend را ری‌استارت کنید:
   ```bash
   cd backend
   node server.js
   ```

2. وارد صفحه مدیریت کاربران شوید و یک کاربر با نقش "انبار دار" بسازید

3. وارد صفحه دسترسی‌ها شوید - باید ستون "انبار دار" را ببینید

4. با کاربر "انبار دار" لاگین کنید و بررسی کنید:
   - ✅ دسترسی به: داشبورد، مدیریت کالاها، درخواست‌ها
   - ❌ عدم دسترسی به: کارها، مدیریت کاربران، واحدها، دسترسی‌ها

### 4. تنظیم دسترسی‌های سفارشی
می‌توانید از صفحه دسترسی‌ها (permissions.html) دسترسی‌های نقش "انبار دار" را تغییر دهید.

## تغییرات اعمال شده:

### فایل‌های Backend:
- ✅ `backend/migrations/add_warehouse_role.sql` - Migration اضافه کردن نقش جدید

### فایل‌های Frontend:
- ✅ `users.html` - اضافه شدن "انبار دار" به لیست نقش‌ها در فرم
- ✅ `permissions.html` - اضافه شدن ستون "انبار دار" به جدول دسترسی‌ها

### دسترسی‌های پیش‌فرض انبار دار:
| صفحه | دسترسی |
|------|--------|
| داشبورد | ✅ دارد |
| کارها | ❌ ندارد |
| درخواست‌ها | ✅ دارد |
| مدیریت کالاها | ✅ دارد |
| مدیریت کاربران | ❌ ندارد |
| واحدها | ❌ ندارد |
| دسترسی‌ها | ❌ ندارد |

## نکات مهم:
- بعد از اجرای Migration، حتماً خروج و ورود مجدد کنید تا کش پرمیشن‌ها پاک شود
- اگر سرور در حال اجرا بود، آن را ری‌استارت کنید
- اگر خطای ENUM دادید، یعنی جدول users هنوز ساخته نشده - ابتدا جدول users را بسازید
